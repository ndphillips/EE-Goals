{
    "collab_server" : "",
    "contents" : "library(yarrr)\nlibrary(BayesFactor)\nlibrary(lsr)\nl.colors <- piratepal(palette = 'basel', trans = .4)\n\n\nx <- seq(-13, 18, length=10000)\nhx1 <- dnorm(x, 3, 5)\nhx2 <- dnorm(x, 2, 2.5)\nhx3 <- dnorm(x, 2, 2)\n\nwindows(height = 8, width = 12)\npar(mar = c(5, 5, 3, 1))\nplot(x, hx1, type=\"l\", col = l.colors[1], xlab=\"Point Value\",\n     ylab=\"Density\", main=\"\", xlim = c(-13, 18), ylim = c(0, .2),\n     lwd = 2, bty = \"l\", cex.lab = 2)\nlines(x, hx2, col = l.colors[3], lwd = 2)\nlines(x, hx3, col = l.colors[4], lwd = 2)\nabline(v = 3, col = l.colors[1], lty = 2, lwd = 2)\nabline(v = 2, col = l.colors[2], lty = 2, lwd = 2)\nabline(v = 2, col = l.colors[3], lty = 3, lwd = 2)\n\nwindows(height = 8, width = 12)\npar(mar = c(5, 5, 3, 1))\nplot(c(5, 2.5, 2), c(3, 2, 2), xlim = c(0, 6), ylim = c(0, 4), xlab = \"Standard Deviation\", ylab = \"Expected Value\",\n     bty = \"l\", pch = 15, col = l.colors[1], cex = 2, xaxs = \"i\", yaxs = \"i\", cex.lab = 1.5)\npoints(c(2, 2.5, 5), c(3, 2, 2), pch = 16, col = l.colors[2], cex = 2)\nlegend(\"topleft\", legend = c(\"HG, HN\", \"LG, LN\"), col = c(l.colors[1:2]), pch = c(15, 16), cex = 1.5)\n\n\n# plots design distributions\n# HG HN\n\nx <- seq(-13, 18, length=10000)\nhx1 <- dnorm(x, 3, 5)\nhx2 <- dnorm(x, 2, 2.5)\nhx3 <- dnorm(x, 2, 2)\n\nwindows(height = 8, width = 12)\npar(mar = c(5, 5, 3, 1))\nplot(x, hx1, type=\"l\", col = l.colors[1], xlab=\"Point Value\",\n     ylab=\"Density\", main=\"\", xlim = c(-13, 18), ylim = c(0, .2),\n     lwd = 2, bty = \"l\", cex.lab = 2, xaxs = \"i\", yaxs = \"i\")\nlines(x, hx2, col = l.colors[3], lwd = 2)\nlines(x, hx3, col = l.colors[4], lwd = 2)\nabline(v = 3, col = l.colors[1], lty = 2, lwd = 2)\nabline(v = 2, col = l.colors[2], lty = 2, lwd = 2)\nabline(v = 2, col = l.colors[3], lty = 3, lwd = 2)\ntext(4.4, .025, expression(paste(mu, \" = 3\")), col = l.colors[1], cex = 2)\ntext(0, .03, expression(paste(mu, \" = 2\")), col = l.colors[3], cex = 2)\ntext(0, .02, expression(paste(mu, \" = 2\")), col = l.colors[4], cex = 2)\n\ntext(10, .052, expression(paste(sigma, \" = 5\")), col = l.colors[1], cex = 2)\ntext(-3.4, .06, expression(paste(sigma, \" = 2.5\")), col = l.colors[3], cex = 2)\ntext(-1.5, .12, expression(paste(sigma, \" = 2\")), col = l.colors[4], cex = 2)\n\n\n\n# LG LN\n\nx <- seq(-13, 18, length=10000)\nhx1 <- dnorm(x, 3, 2)\nhx2 <- dnorm(x, 2, 2.5)\nhx3 <- dnorm(x, 2, 5)\n\nwindows(height = 8, width = 12)\npar(mar = c(5, 5, 3, 1))\nplot(x, hx1, type=\"l\", col = l.colors[1], xlab=\"Point Value\",\n     ylab=\"Density\", main=\"\", xlim = c(-13, 18), ylim = c(0, .2),\n     lwd = 2, bty = \"l\", cex.lab = 2, xaxs = \"i\", yaxs = \"i\")\nlines(x, hx2, col = l.colors[3], lwd = 2)\nlines(x, hx3, col = l.colors[4], lwd = 2)\nabline(v = 3, col = l.colors[1], lty = 2, lwd = 2)\nabline(v = 2, col = l.colors[2], lty = 2, lwd = 2)\nabline(v = 2, col = l.colors[3], lty = 3, lwd = 2)\ntext(4.4, .025, expression(paste(mu, \" = 3\")), col = l.colors[1], cex = 2)\ntext(0.5, .03, expression(paste(mu, \" = 2\")), col = l.colors[3], cex = 2)\ntext(0.5, .02, expression(paste(mu, \" = 2\")), col = l.colors[4], cex = 2)\n\ntext(7.5, .08, expression(paste(sigma, \" = 2\")), col = l.colors[1], cex = 2)\ntext(-2.7, .1, expression(paste(sigma, \" = 2.5\")), col = l.colors[3], cex = 2)\ntext(-5, .048, expression(paste(sigma, \" = 5\")), col = l.colors[4], cex = 2)\n\n\n###\n# pirateplot of how hard they found it to earn points\ndf <- readRDS(\"dataParticipantLevel.rds\")\nclass(df$condition.x)\ndf$condition.x <- factor(df$condition.x, labels = c(\"LN\", \"HN\", \"LG\", \"HG\"))\nwindows(height = 8, width = 12)\npirateplot(game.difficulty ~ condition.x, data = df, ylim = c(0,5), ylab = \"\", xlab = \"\", cex.lab = 1.5, cex.axis = 1.5)\n\n\n# points over games\nwindows(height = 8, width = 12)\npirateplot(outcome.sum ~ condition.x, data = df, ylim = c(500,900), ylab = \"\", xlab = \"\", cex.lab = 1.5, cex.axis = 1.5)\n\n\n# switch rates\nwindows(height = 8, width = 12)\npirateplot(mean.switched ~ condition.x, data = df, ylim = c(0,1), ylab = \"\", xlab = \"\", cex.lab = 1.5, cex.axis = 1.5)\ndf$goal <- ifelse(df$condition.x %in% c(\"LG\", \"HG\"), 1, 0)\ndf$Henv <- ifelse(df$condition.x %in% c(\"LG\", \"LN\"), 0, 1)\nsummary(lm(mean.switched ~ condition.x, data = df))\n\nt.test(mean.switched ~ condition.x, data = subset(df, condition.x %in% c( \"LG\", \"LN\")))\ncohensD(df$mean.switched[df$condition.x == \"LN\"],df$mean.switched[df$condition.x == \"LG\"])\n\nt.test(mean.switched ~ condition.x, data = subset(df, condition.x %in% c( \"HG\", \"HN\")))\ncohensD(df$mean.switched[df$condition.x == \"HN\"],df$mean.switched[df$condition.x == \"HG\"])\n\n\n# prop hgih EV chosen\n\nwindows(height = 8, width = 12)\npirateplot(highEV.mean ~ condition.x, data = df, ylim = c(0,1), ylab = \"\", xlab = \"\", cex.lab = 1.5, cex.axis = 1.5)\nplot(generalTestBF(highEV.mean ~ condition.x, data = df))\nt.test(df$highEV.mean[df$condition.x == \"LG\"], df$highEV.mean[df$condition.x != \"LG\"])\ncohensD(df$highEV.mean[df$condition.x == \"LG\"], df$highEV.mean[df$condition.x != \"LG\"])\n\n\n\n# hist of goal reached\nwindows(height = 8, width = 12)\nhist(df$goalReached.mean.NP[df$condition.x == \"HG\"], col = transparent(\"red\", .4), breaks = 10, main = \"Proportion of Games with Goal reached\", xlab = \"p Games with goal reached\", ylim = c(0, 10), cex.lab = 1.5)\nhist(df$goalReached.mean.NP[df$condition.x == \"LG\"], col = transparent(\"blue\", .4), breaks = 10, add = T, cex.lab = 1.5)\nlegend(\"topright\", legend = c(\"Condition LG\", \"Condition HG\"), col = c(transparent(\"blue\", .4), transparent(\"red\", .4)), pch = 15, cex = 1.5)\n\nplot(generalTestBF(goalReached.mean.NP ~ condition.x, data = subset(df, condition.x %in% c(\"LG\", \"HG\"))))\nt.test(goalReached.mean.NP ~ condition.x, data = subset(df, condition.x %in% c(\"LG\", \"HG\")))\n\n\ndf.t <- readRDS(\"dataTrialLevel.rds\")\n\nn.df <- aggregate(switched ~ participant + game + overGoal + condition, FUN = mean, data = subset(df.t, condition %in% 3:4 & game > 1 & trial >=40))\nn.df$condition <- factor(n.df$condition, labels = c(\"LG\", \"HG\"))\n\nwindows(height = 8, width = 12)\npar(mar = c(5, 5.1, 4, 1))\npirateplot(switched ~ overGoal + condition, data = n.df, cex.lab = 1.5, ylab = \"\")\nt.test(switched ~ overGoal, data = subset(n.df, condition == \"LG\"))\nplot(generalTestBF(switched ~ overGoal, data = subset(n.df, condition == \"LG\")))\n\n\n# highEV chosen over vs under goal\n\nn.df <- aggregate(highEV ~ participant + game + overGoal + condition, FUN = mean, data = subset(df.t, condition %in% 3:4 & game > 1 & trial >=40))\nn.df$condition <- factor(n.df$condition, labels = c(\"LG\", \"HG\"))\n\nwindows(height = 8, width = 12)\npar(mar = c(5, 5.1, 4, 1))\npirateplot(highEV ~ overGoal + condition, data = n.df, cex.lab = 1.5, ylab = \"\")\nt.test(highEV ~ overGoal, data = subset(n.df, condition == \"LG\"))\nplot(generalTestBF(highEV ~ overGoal, data = subset(n.df, condition == \"LG\")))\n\n# p getthere plots\n\ndf.trial <- readRDS(\"dataTrialLevelPGetthere.rds\")\n\n\n\n\n\n\n# check condition 3\nn.df1 <- aggregate(high.var.chosen ~ choose.highvar + participant + game, FUN = mean, data = subset(df.trial, condition == 3 & trial >= 40))\nnames(n.df1)\npirateplot(high.var.chosen ~ choose.highvar, data = n.df1, ylab = \"\", main = \"\", xlab = \"\")\n\n\ngeneralTestBF(high.var.chosen ~ choose.highvar, data = n.df1)\nplot(generalTestBF(high.var.chosen ~ choose.highvar, data = n.df1))\nt.test(high.var.chosen ~ choose.highvar, data = n.df1)\ncohensD(high.var.chosen ~ choose.highvar, data = n.df1)\n\n\n# aaaand subjective\nwindows(height = 8, width = 12)\npar(mar = c(5, 5.1, 4, 1))\nn.df1.s <- aggregate(high.var.chosen ~ choose.highvar.subj + participant + game, FUN = mean, data = subset(df.trial, condition == 3 & trial >= 20))\nnames(n.df1.s)\npirateplot(high.var.chosen ~ choose.highvar.subj, data = n.df1.s, ylab = \"\", main = \"\", xlab = \"\")\ntable(n.df1$choose.highvar)\n\ngeneralTestBF(high.var.chosen ~ choose.highvar.subj, data = n.df1.s)\nplot(generalTestBF(high.var.chosen ~ choose.highvar.subj, data = n.df1.s))\nt.test(high.var.chosen ~ choose.highvar.subj, data = n.df1.s)\ncohensD(high.var.chosen ~ choose.highvar.subj, data = n.df1.s)\n\n\n### check condiiton 1\nn.df2 <- aggregate(high.var.chosen ~ choose.highvar + participant + game, FUN = mean, data = subset(df.trial, condition == 1 & trial >= 40))\nnames(n.df2)\npirateplot(high.var.chosen ~ choose.highvar, data = n.df2, ylab = \"\", main = \"\", xlab = \"\")\n\n\ngeneralTestBF(high.var.chosen ~ choose.highvar, data = n.df2)\nplot(generalTestBF(high.var.chosen ~ choose.highvar, data = n.df2))\nt.test()\n\n\n# aaaand subjective\nn.df2.s <- aggregate(high.var.chosen ~ choose.highvar + participant + game, FUN = mean, data = subset(df.trial, condition == 1 & trial >= 40))\nnames(n.df2.s)\npirateplot(high.var.chosen ~ choose.highvar, data = n.df2.s, ylab = \"p high var option chosen\", main = \"Prop high variance chosen when rational vs not\")\n\n\ngeneralTestBF(high.var.chosen ~ choose.highvar, data = n.df2.s)\nplot(generalTestBF(high.var.chosen ~ choose.highvar, data = n.df2.s))\n\n\n\n### var over goal analysis\no.df <- readRDS(\"dataTrialLevelPGetthereOG.rds\")\no.df$condition <- factor(o.df$condition, labels = c(\"LN\", \"HN\", \"LG\", \"HG\"))\n# check condition 3\n\nn.df1 <- aggregate(high.var.chosen ~ choose.highvar + participant + game, FUN = mean, data = subset(o.df, condition == \"HG\" & trial >= 40 & overGoal == 0))\nnames(n.df1)\npirateplot(high.var.chosen ~ choose.highvar, data = n.df1, ylab = \"\", main = \"\", xlab = \"\")\n\n\ngeneralTestBF(high.var.chosen ~ choose.highvar, data = n.df1)\nplot(generalTestBF(high.var.chosen ~ choose.highvar, data = n.df1))\nt.test(high.var.chosen ~ choose.highvar, data = n.df1)\ncohensD(high.var.chosen ~ choose.highvar, data = n.df1)\n\n\n# aaaand subjective\nn.df1.s <- aggregate(high.var.chosen ~ choose.highvar.subj + participant + game, FUN = mean, data = subset(o.df, condition == \"HG\" & trial >= 40 & overGoal == 1))\nnames(n.df1.s)\nwindows(height = 8, width = 12)\npar(mar = c(5, 4, 4, 1))\npirateplot(high.var.chosen ~ choose.highvar.subj, data = n.df1.s, ylab = \"\", main = \"\", xlab = \"\")\n\n\ngeneralTestBF(high.var.chosen ~ choose.highvar.subj, data = n.df1.s)\nplot(generalTestBF(high.var.chosen ~ choose.highvar.subj, data = n.df1.s))\nt.test(high.var.chosen ~ choose.highvar.subj, data = n.df1.s)\ncohensD(high.var.chosen ~ choose.highvar.subj, data = n.df1.s)\n\n",
    "created" : 1490600725757.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3202967648",
    "id" : "50432C18",
    "lastKnownWriteTime" : 1490079884,
    "last_content_update" : 1490079884,
    "path" : "C:/Users/Markus/Dropbox/Masterarbeit/PilotPresentation/plotsPresentation.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}